{% extends 'base_public.html' %}
{% block title %}Log in â€“ {{ app_name }}{% endblock %}
{% block content %}
<div class="max-w-6xl mx-auto grid lg:grid-cols-2 gap-12 items-center">
  <!-- Left Column: Value Reminder & Stats -->
  <div class="hidden lg:block">
    <div class="mb-6">
      <span class="inline-flex items-center px-4 py-2 rounded-full bg-primary-100 text-primary-700 text-sm font-semibold">
        ðŸ‘‹ Welcome back
      </span>
    </div>

    <h1 class="text-4xl font-extrabold text-gray-900 mb-4">
      Continue Growing Your Business
    </h1>
    <p class="text-xl text-gray-600 mb-8">
      Check your latest AI insights, track your performance, and optimize your campaigns.
    </p>

    <!-- Quick Stats/Benefits -->
    <div class="bg-gradient-to-br from-primary-600 to-accent-600 rounded-2xl p-8 text-white shadow-xl mb-8">
      <h3 class="text-2xl font-bold mb-6">Your Dashboard Awaits</h3>
      <div class="space-y-4">
        <div class="flex items-center gap-3">
          <div class="flex-shrink-0 w-10 h-10 rounded-full bg-white bg-opacity-20 flex items-center justify-center">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
            </svg>
          </div>
          <div>
            <div class="font-semibold">Real-time Performance</div>
            <div class="text-sm text-primary-100">See today's leads, spend, and ROI</div>
          </div>
        </div>

        <div class="flex items-center gap-3">
          <div class="flex-shrink-0 w-10 h-10 rounded-full bg-white bg-opacity-20 flex items-center justify-center">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
            </svg>
          </div>
          <div>
            <div class="font-semibold">AI Recommendations</div>
            <div class="text-sm text-primary-100">Fresh insights updated daily</div>
          </div>
        </div>

        <div class="flex items-center gap-3">
          <div class="flex-shrink-0 w-10 h-10 rounded-full bg-white bg-opacity-20 flex items-center justify-center">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          </div>
          <div>
            <div class="font-semibold">Budget Optimization</div>
            <div class="text-sm text-primary-100">Auto-adjusting to save you money</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Mini Testimonial -->
    <div class="bg-white border rounded-xl p-6 shadow-md">
      <p class="text-gray-700 italic mb-3">"I check FieldSprout every morning. It's become as essential as my coffee."</p>
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-full bg-gradient-to-br from-green-400 to-green-600 flex items-center justify-center text-white font-bold">
          S
        </div>
        <div>
          <div class="font-semibold text-gray-900">Sarah Chen</div>
          <div class="text-sm text-gray-600">Elite Plumbing</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Right Column: Login Form -->
  <div class="w-full">
    <div class="bg-white border-2 border-gray-200 rounded-2xl p-8 shadow-xl">
      <!-- Mobile-only header -->
      <div class="lg:hidden mb-6 text-center">
        <span class="inline-flex items-center px-4 py-2 rounded-full bg-primary-100 text-primary-700 text-sm font-semibold mb-3">
          ðŸ‘‹ Welcome back
        </span>
        <h1 class="text-2xl font-bold text-gray-900">Log in to your account</h1>
      </div>

      <!-- Desktop-only header -->
      <div class="hidden lg:block mb-8">
        <h2 class="text-3xl font-bold text-gray-900 mb-2">Welcome back</h2>
        <p class="text-gray-600">Log in to access your dashboard</p>
      </div>

      <form method="post" class="space-y-5" novalidate id="login-form">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <input type="hidden" name="next" value="{{ next or request.args.get('next','') }}">
        <!-- simple honeypot -->
        <input type="text" name="company" tabindex="-1" autocomplete="off" class="hidden" aria-hidden="true">

        <div>
          <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
          <input
            id="email"
            name="email"
            type="email"
            inputmode="email"
            autocomplete="email"
            required
            value="{{ request.values.get('email', request.args.get('email','')) }}"
            class="w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-colors"
            placeholder="you@business.com"
          >
        </div>

        <div>
          <div class="flex items-center justify-between mb-1">
            <label for="password" class="block text-sm font-medium text-gray-700">Password</label>
            <a href="{{ url_for('auth_bp.forgot_password') }}" class="text-sm text-primary-600 hover:text-primary-700 hover:underline">
              Forgot password?
            </a>
          </div>
          <input
            id="password"
            name="password"
            type="password"
            autocomplete="current-password"
            required
            minlength="6"
            class="w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-colors"
            placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
          >
        </div>

        <button
          id="login-submit"
          type="submit"
          class="w-full px-6 py-4 bg-gradient-to-r from-primary-600 to-accent-600 text-white font-bold text-lg rounded-lg hover:from-primary-700 hover:to-accent-700 focus:ring-4 focus:ring-primary-300 shadow-lg transition-all transform hover:scale-105"
        >
          Log In
        </button>
      </form>

      {# Show "Resend verification email" ONLY after a submission #}
      {% if request.method == 'POST' %}
        <div class="mt-4">
          <form method="post" action="{{ url_for('auth_bp.resend_verification') }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <input
              type="hidden"
              name="email"
              value="{{ request.form.get('email', '') }}"
            >
            <button type="submit" class="text-sm text-primary-600 hover:text-primary-700 hover:underline">
              Resend verification email
            </button>
          </form>
        </div>
      {% endif %}

      <div class="mt-8 pt-6 border-t border-gray-200">
        <p class="text-sm text-gray-600 text-center">
          New to FieldSprout?
          <a href="{{ url_for(ep('register'), next=request.args.get('next','')) }}" class="text-primary-600 hover:text-primary-700 font-semibold hover:underline">
            Create an account
          </a>
        </p>
        <p class="text-xs text-gray-500 text-center mt-2">
          14-day free trial â€¢ No credit card required
        </p>
      </div>
    </div>

    <!-- Additional Info Below Form -->
    <div class="mt-6 text-center">
      <p class="text-sm text-gray-600">
        ðŸ”’ Your login is secure and encrypted
      </p>
    </div>
  </div>
</div>

<script>
  // Prevent double-submits
  const form = document.getElementById('login-form');
  const btn = document.getElementById('login-submit');
  form?.addEventListener('submit', () => {
    if (btn) {
      btn.disabled = true;
      btn.textContent = 'Logging in...';
    }
  });
</script>
{% endblock %}
